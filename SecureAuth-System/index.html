<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>분산 패스워드 보안 시스템 - 침입 탐지 강화</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea, #764ba2);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            color: white;
        }

        .navbar {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 1.5em;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-link {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: #4CAF50;
        }

        /* 보안 상태 표시 */
        .security-alert {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            z-index: 999;
            transition: all 0.3s ease;
            display: none;
        }

        .security-alert.normal {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid #4CAF50;
            color: #4CAF50;
        }

        .security-alert.warning {
            background: rgba(255, 193, 7, 0.3);
            border: 1px solid #FFC107;
            color: #FFC107;
            animation: pulse 2s infinite;
        }

        .security-alert.danger {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid #f44336;
            color: #f44336;
            animation: alert-blink 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }

        @keyframes alert-blink {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .main-content {
            margin-top: 80px;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: calc(100vh - 80px);
            align-items: center;
        }

        .page {
            display: none;
            width: 100%;
            max-width: 1000px;
        }

        .page.active {
            display: block;
        }

        /* 사용자 사이트 스타일 */
        .user-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 500px;
            margin: 0 auto;
        }

        .site-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #e0e0e0;
        }

        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus, input[type="password"]:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        input.locked {
            background: rgba(244, 67, 54, 0.2) !important;
            border: 1px solid #f44336;
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn:disabled {
            background: rgba(128, 128, 128, 0.5);
            cursor: not-allowed;
            transform: none;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .auth-tab.active {
            border-bottom-color: #667eea;
            background: rgba(255, 255, 255, 0.1);
        }

        .auth-content {
            display: none;
        }

        .auth-content.active {
            display: block;
        }

        /* 서버 관리 스타일 */
        .server-container {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .server-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .server-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .server-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .server-card.active {
            border-color: #4CAF50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.3);
        }

        .server-card.error {
            border-color: #f44336;
            box-shadow: 0 0 20px rgba(244, 67, 54, 0.3);
        }

        .server-card.lockdown {
            border-color: #ff9800;
            box-shadow: 0 0 20px rgba(255, 152, 0, 0.5);
            background: rgba(255, 152, 0, 0.1);
            animation: security-pulse 2s infinite;
        }

        @keyframes security-pulse {
            0% { box-shadow: 0 0 20px rgba(255, 152, 0, 0.3); }
            50% { box-shadow: 0 0 30px rgba(255, 152, 0, 0.7); }
            100% { box-shadow: 0 0 20px rgba(255, 152, 0, 0.3); }
        }

        .server-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .server-name {
            font-size: 1.3em;
            font-weight: bold;
        }

        .server-status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .status-online {
            background: rgba(76, 175, 80, 0.3);
            color: #4CAF50;
        }

        .status-offline {
            background: rgba(244, 67, 54, 0.3);
            color: #f44336;
        }

        .status-lockdown {
            background: rgba(255, 152, 0, 0.3);
            color: #ff9800;
            animation: status-blink 1s infinite;
        }

        @keyframes status-blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .server-info {
            color: #b0b0b0;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .server-data {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }

        .server-controls {
            text-align: center;
            margin-top: 30px;
        }

        .control-btn {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            border: none;
            padding: 10px 25px;
            border-radius: 20px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .control-btn.danger {
            background: linear-gradient(45deg, #ff7675, #d63031);
        }

        .control-btn.warning {
            background: linear-gradient(45deg, #fdcb6e, #e17055);
        }

        .status-message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 600;
        }

        .success {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid #4CAF50;
        }

        .error {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid #f44336;
        }

        .warning {
            background: rgba(255, 193, 7, 0.3);
            border: 1px solid #FFC107;
            color: #FFC107;
        }

        .hash-display {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            line-height: 1.5;
        }

        .user-list {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-bottom: 5px;
        }

        .user-item:last-child {
            border-bottom: none;
        }

        .user-item.locked {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
        }

        .user-item.suspicious {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid #FFC107;
        }

        .security-log {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-entry {
            font-family: monospace;
            font-size: 11px;
            padding: 5px;
            margin: 2px 0;
            border-radius: 3px;
        }

        .log-info { background: rgba(33, 150, 243, 0.2); }
        .log-warning { background: rgba(255, 193, 7, 0.2); }
        .log-error { background: rgba(244, 67, 54, 0.2); }
        .log-critical { background: rgba(156, 39, 176, 0.3); animation: log-flash 2s infinite; }

        @keyframes log-flash {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* 반응형 디자인 */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .nav-links {
                width: 100%;
                justify-content: center;
            }
            
            .main-content {
                margin-top: 120px;
                padding: 10px;
            }
            
            .user-container, .server-container {
                padding: 20px;
            }
            
            .server-grid {
                grid-template-columns: 1fr;
            }

            .security-alert {
                right: 10px;
                top: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- 보안 상태 알림 -->
    <div id="security-alert" class="security-alert">
        <span id="security-status">🔒 보안 상태 정상</span>
    </div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">🛡️ SecureAuth System</div>
            <div class="nav-links">
                <div class="nav-link active" id="nav-user-site">사용자 사이트</div>
                <div class="nav-link" id="nav-server-admin">서버 관리</div>
                <div class="nav-link" id="nav-security">보안 모니터링</div>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <!-- 사용자 사이트 페이지 -->
        <div id="user-site" class="page active">
            <div class="user-container">
                <h1 class="site-title">🌟 SecureAuth</h1>
                <p style="text-align: center; margin-bottom: 30px; color: #b0b0b0;">
                    차세대 분산 보안 인증 시스템 - 침입 탐지 강화
                </p>
                
                <div class="auth-tabs">
                    <div class="auth-tab active" id="tab-signup">회원가입</div>
                    <div class="auth-tab" id="tab-login">로그인</div>
                </div>
                
                <div id="signup-content" class="auth-content active">
                    <div class="form-group">
                        <label for="signup-username">사용자 ID</label>
                        <input type="text" id="signup-username" placeholder="원하는 ID를 입력하세요">
                    </div>
                    
                    <div class="form-group">
                        <label for="signup-password">패스워드</label>
                        <input type="password" id="signup-password" placeholder="안전한 패스워드를 입력하세요">
                    </div>
                    
                    <div class="form-group">
                        <label for="signup-confirm">패스워드 확인</label>
                        <input type="password" id="signup-confirm" placeholder="패스워드를 다시 입력하세요">
                    </div>
                    
                    <button class="btn" id="signup-btn">🚀 회원가입</button>
                    
                    <div id="signup-result" class="hash-display" style="display:none;">
                        <strong>✅ 계정 생성 완료!</strong><br>
                        생성된 128비트 해시: <span id="signup-hash"></span><br>
                        <small>패스워드가 5개 서버에 안전하게 분산 저장되었습니다.</small>
                    </div>
                </div>
                
                <div id="login-content" class="auth-content">
                    <div class="form-group">
                        <label for="login-username">사용자 ID</label>
                        <input type="text" id="login-username" placeholder="ID를 입력하세요">
                    </div>
                    
                    <div class="form-group">
                        <label for="login-password">패스워드</label>
                        <input type="password" id="login-password" placeholder="패스워드를 입력하세요">
                    </div>
                    
                    <button class="btn" id="login-btn">🔓 로그인</button>
                    
                    <div id="login-result"></div>
                </div>
                
                <div id="user-status" class="status-message" style="display:none;"></div>
            </div>
        </div>

        <!-- 서버 관리 페이지 -->
        <div id="server-admin" class="page">
            <div class="server-container">
                <h1 class="server-title">🖥️ 분산 패스워드 저장 서버 관리</h1>
                
                <div class="server-grid">
                    <div class="server-card" id="server-A">
                        <div class="server-header">
                            <div class="server-name">Server A - Primary</div>
                            <div class="server-status status-offline" id="status-A">OFFLINE</div>
                        </div>
                        <div class="server-info">32비트 해시 + 사용자 메타데이터</div>
                        <div class="server-data" id="data-A">서버 대기 중...</div>
                    </div>
                    
                    <div class="server-card" id="server-B">
                        <div class="server-header">
                            <div class="server-name">Server B - Auth</div>
                            <div class="server-status status-offline" id="status-B">OFFLINE</div>
                        </div>
                        <div class="server-info">32비트 해시 + 인증 이력</div>
                        <div class="server-data" id="data-B">서버 대기 중...</div>
                    </div>
                    
                    <div class="server-card" id="server-C">
                        <div class="server-header">
                            <div class="server-name">Server C - Context</div>
                            <div class="server-status status-offline" id="status-C">OFFLINE</div>
                        </div>
                        <div class="server-info">32비트 해시 + 컨텍스트 정보</div>
                        <div class="server-data" id="data-C">서버 대기 중...</div>
                    </div>
                    
                    <div class="server-card" id="server-D">
                        <div class="server-header">
                            <div class="server-name">Server D - Verification</div>
                            <div class="server-status status-offline" id="status-D">OFFLINE</div>
                        </div>
                        <div class="server-info">16비트 해시 + 검증 데이터</div>
                        <div class="server-data" id="data-D">서버 대기 중...</div>
                    </div>
                    
                    <div class="server-card" id="server-E">
                        <div class="server-header">
                            <div class="server-name">Server E - Recovery</div>
                            <div class="server-status status-offline" id="status-E">OFFLINE</div>
                        </div>
                        <div class="server-info">16비트 해시 + 복구 시드</div>
                        <div class="server-data" id="data-E">서버 대기 중...</div>
                    </div>
                </div>
                
                <div class="user-list">
                    <h3>📋 등록된 사용자 목록</h3>
                    <div id="user-list-content">등록된 사용자가 없습니다.</div>
                </div>
                
                <div class="server-controls">
                    <button class="control-btn" id="refresh-btn">🔄 서버 상태 새로고침</button>
                    <button class="control-btn" id="sync-btn">🔄 서버 동기화</button>
                    <button class="control-btn warning" id="lockdown-btn">🔒 보안 잠금</button>
                    <button class="control-btn danger" id="clear-btn">🗑️ 모든 데이터 삭제</button>
                </div>
                
                <div id="admin-status"></div>
            </div>
        </div>

        <!-- 보안 모니터링 페이지 -->
        <div id="security-monitoring" class="page">
            <div class="server-container">
                <h1 class="server-title">🛡️ 보안 침입 탐지 시스템</h1>
                
                <div class="security-log">
                    <h3>📊 실시간 보안 로그</h3>
                    <div id="security-log-content">
                        <div class="log-entry log-info">[INFO] 보안 모니터링 시스템이 시작되었습니다.</div>
                    </div>
                </div>
                
                <div class="server-controls">
                    <button class="control-btn" id="clear-log-btn">📝 로그 지우기</button>
                    <button class="control-btn warning" id="test-attack-btn">🎯 해킹 시도 시뮬레이션</button>
                    <button class="control-btn danger" id="emergency-lockdown-btn">🚨 긴급 잠금</button>
                </div>
                
                <div id="security-status"></div>
            </div>
        </div>
    </div>

    <script>
        // 글로벌 변수들
        let userData = {};
        let serverStatus = {
            A: false, B: false, C: false, D: false, E: false
        };
        let securityState = 'normal'; // normal, warning, danger
        let isLockdownMode = false;
        let lockedAccounts = new Set();
        let suspiciousIPs = new Set();
        let securityLog = [];

        // 보안 이벤트 타입 정의
        const SecurityEvents = {
            NORMAL: 'normal',
            SUSPICIOUS: 'suspicious',
            ATTACK: 'attack',
            LOCKDOWN: 'lockdown'
        };

        // ChaoticRNG 클래스
        class ChaoticRNG {
            constructor(seed, key = 314159, r = 3.99) {
                this.x = (seed % 4294967295) / 4294967295.0;
                this.k = (key % 4294967295) / 4294967295.0;
                this.r = r;
                this.i = 0;
                this.keyMod = key % 101;
            }
            
            next() {
                this.x = this.r * this.x * (1.0 - this.x);
                let y = (this.x + this.k + ((this.i % 251) / 997.0)) % 1.0;
                let val = Math.floor(y * (Math.pow(2, 53) - 1));
                this.x = (this.x + y + this.keyMod) % 1.0;
                this.i++;
                return val;
            }
        }

        // 해킹 시도 탐지 클래스
        class SecurityMonitor {
            constructor() {
                this.suspiciousAttempts = {};
                this.ipAttempts = {};
                this.lastAttempts = {};
                this.threshold = {
                    maxFailedAttempts: 3,
                    timeWindow: 60000, // 1분
                    suspiciousInterval: 5000, // 5초 이내 반복 시도
                    maxIPAttempts: 5
                };
            }

            checkSuspiciousActivity(username, ip, success) {
                const now = Date.now();
                const userKey = `${username}_${ip}`;
                
                // IP별 시도 횟수 추적
                if (!this.ipAttempts[ip]) {
                    this.ipAttempts[ip] = [];
                }
                this.ipAttempts[ip].push(now);
                
                // 시간 윈도우 밖의 시도 제거
                this.ipAttempts[ip] = this.ipAttempts[ip].filter(time => 
                    now - time < this.threshold.timeWindow
                );

                // 사용자별 실패 시도 추적
                if (!success) {
                    if (!this.suspiciousAttempts[userKey]) {
                        this.suspiciousAttempts[userKey] = [];
                    }
                    this.suspiciousAttempts[userKey].push(now);
                    
                    // 시간 윈도우 밖의 시도 제거
                    this.suspiciousAttempts[userKey] = this.suspiciousAttempts[userKey].filter(time => 
                        now - time < this.threshold.timeWindow
                    );
                }

                // 마지막 시도 시간 확인
                if (this.lastAttempts[userKey]) {
                    const timeDiff = now - this.lastAttempts[userKey];
                    if (timeDiff < this.threshold.suspiciousInterval) {
                        this.logSecurity('warning', `빠른 연속 시도 감지: ${username} from ${ip}`);
                        return 'rapid_attempts';
                    }
                }
                this.lastAttempts[userKey] = now;

                // 공격 탐지 로직
                if (this.ipAttempts[ip].length > this.threshold.maxIPAttempts) {
                    this.logSecurity('critical', `IP 기반 공격 탐지: ${ip} (${this.ipAttempts[ip].length} 시도)`);
                    return 'ip_attack';
                }

                if (!success && this.suspiciousAttempts[userKey] && 
                    this.suspiciousAttempts[userKey].length >= this.threshold.maxFailedAttempts) {
                    this.logSecurity('critical', `브루트포스 공격 탐지: ${username} from ${ip}`);
                    return 'brute_force';
                }

                return 'normal';
            }

            logSecurity(level, message) {
                const timestamp = new Date().toISOString();
                const entry = { timestamp, level, message };
                securityLog.push(entry);
                
                // 로그가 너무 많아지면 오래된 항목 제거
                if (securityLog.length > 100) {
                    securityLog.shift();
                }
                
                updateSecurityLog();
                console.log(`[SECURITY ${level.toUpperCase()}] ${message}`);
            }

            triggerEmergencyResponse(threatType, details) {
                this.logSecurity('critical', `🚨 긴급 보안 대응 발동: ${threatType} - ${details}`);
                
                // 모든 서버를 보안 잠금 상태로 전환
                enterSystemLockdown();
                
                // 관련 계정 잠금
                if (details.includes('from')) {
                    const parts = details.split(' ');
                    const username = parts[0];
                    lockAccount(username, threatType);
                }
                
                // 의심스러운 IP 차단
                if (details.includes('from')) {
                    const ip = details.split('from ')[1].split(' ')[0];
                    suspiciousIPs.add(ip);
                    this.logSecurity('warning', `IP 주소 차단: ${ip}`);
                }

                updateSecurityStatus('danger', `🚨 보안 위협 탐지: ${threatType}`);
            }
        }

        const securityMonitor = new SecurityMonitor();

        // 해시 함수들
        function customHash(input, seed) {
            let rng = new ChaoticRNG(seed);
            let hash = 0;
            
            for (let i = 0; i < input.length; i++) {
                let char = input.charCodeAt(i);
                hash = (hash + char * rng.next()) % (Math.pow(2, 53) - 1);
            }
            
            for (let round = 0; round < 5; round++) {
                hash = (hash * rng.next()) % (Math.pow(2, 53) - 1);
            }
            
            return hash;
        }

        function generateAdvancedHash(username, password) {
            let seedStr = username + ":" + password;
            let seed = 0;
            
            for (let i = 0; i < seedStr.length; i++) {
                seed = ((seed << 5) - seed + seedStr.charCodeAt(i)) & 0xffffffff;
            }
            
            let hash1 = customHash(password + username, seed);
            let hash2 = customHash(username + password, seed ^ 0xABCDEF);
            let hash3 = customHash(password + "salt1" + username, seed ^ 0x123456);
            let hash4 = customHash(username + "salt2" + password, seed ^ 0x789ABC);
            
            return {
                block1: (hash1 % Math.pow(2, 32)).toString(16).padStart(8, '0'),
                block2: (hash2 % Math.pow(2, 32)).toString(16).padStart(8, '0'),
                block3: (hash3 % Math.pow(2, 32)).toString(16).padStart(8, '0'),
                block4: (hash4 % Math.pow(2, 32)).toString(16).padStart(8, '0')
            };
        }

        function splitHash(hashBlocks, username) {
            const now = new Date().toISOString();
            const ip = generateRandomIP();
            
            return {
                serverA: {
                    hashFragment: hashBlocks.block1,
                    metadata: {
                        username: username,
                        created: now,
                        lastAccess: now,
                        userLevel: "standard",
                        isLocked: false,
                        lockReason: null
                    }
                },
                serverB: {
                    hashFragment: hashBlocks.block2,
                    authHistory: {
                        loginCount: 0,
                        lastLogin: null,
                        failedAttempts: 0,
                        loginHistory: [],
                        suspiciousActivity: false
                    }
                },
                serverC: {
                    hashFragment: hashBlocks.block3,
                    context: {
                        ipAddress: ip,
                        userAgent: "SecureSystem/2.0",
                        sessionId: Math.random().toString(36).substr(2, 12),
                        location: "Seoul, KR",
                        securityLevel: "normal"
                    }
                },
                serverD: {
                    hashFragment: hashBlocks.block4.substr(0, 4),
                    verification: {
                        checksum: hashBlocks.block4.substr(4, 4),
                        integrity: true,
                        lastVerified: now,
                        securityEvents: []
                    }
                },
                serverE: {
                    hashFragment: hashBlocks.block4.substr(4, 4),
                    recovery: {
                        seed: Math.random().toString(36).substr(2, 10),
                        backupHash: hashBlocks.block1.substr(0, 4),
                        recoveryKey: Math.random().toString(36).substr(2, 8),
                        backupLocked: false
                    }
                }
            };
        }

        // 보안 함수들
        function generateRandomIP() {
            return `192.168.1.${Math.floor(Math.random() * 255)}`;
        }

        function updateSecurityStatus(level, message) {
            const alertElement = document.getElementById('security-alert');
            const statusElement = document.getElementById('security-status');
            
            alertElement.className = `security-alert ${level}`;
            statusElement.textContent = message;
            alertElement.style.display = 'block';
            
            securityState = level;
            
            if (level === 'danger') {
                // 위험 상태일 때는 계속 표시
                clearTimeout(window.securityTimeout);
            } else {
                // 일반/경고 상태는 5초 후 숨김
                clearTimeout(window.securityTimeout);
                window.securityTimeout = setTimeout(() => {
                    if (securityState !== 'danger') {
                        alertElement.style.display = 'none';
                    }
                }, 5000);
            }
        }

        function enterSystemLockdown() {
            isLockdownMode = true;
            
            // 모든 서버를 잠금 상태로 변경
            Object.keys(serverStatus).forEach(server => {
                if (serverStatus[server]) {
                    const serverCard = document.getElementById(`server-${server}`);
                    const statusElement = document.getElementById(`status-${server}`);
                    
                    serverCard.classList.add('lockdown');
                    statusElement.textContent = 'LOCKDOWN';
                    statusElement.className = 'server-status status-lockdown';
                }
            });

            // 사용자 인터페이스 잠금
            const loginBtn = document.getElementById('login-btn');
            const signupBtn = document.getElementById('signup-btn');
            
            if (loginBtn) {
                loginBtn.disabled = true;
                loginBtn.textContent = '🔒 시스템 잠금 중';
            }
            
            if (signupBtn) {
                signupBtn.disabled = true;
                signupBtn.textContent = '🔒 시스템 잠금 중';
            }

            securityMonitor.logSecurity('critical', '🔒 시스템 전체 보안 잠금 모드 진입');
            updateSecurityStatus('danger', '🚨 보안 잠금 모드 - 모든 인증 차단됨');
            
            showAdminStatus('🚨 긴급 보안 잠금이 활성화되었습니다. 모든 서버가 보안 상태로 전환되었습니다.', 'error');
        }

        function exitSystemLockdown() {
            if (!confirm('⚠️ 정말로 보안 잠금을 해제하시겠습니까?\n모든 위협이 제거되었는지 확인하세요.')) {
                return;
            }

            isLockdownMode = false;
            
            // 서버 상태 복구
            Object.keys(serverStatus).forEach(server => {
                if (serverStatus[server]) {
                    const serverCard = document.getElementById(`server-${server}`);
                    const statusElement = document.getElementById(`status-${server}`);
                    
                    serverCard.classList.remove('lockdown');
                    statusElement.textContent = 'ONLINE';
                    statusElement.className = 'server-status status-online';
                }
            });

            // 사용자 인터페이스 복구
            const loginBtn = document.getElementById('login-btn');
            const signupBtn = document.getElementById('signup-btn');
            
            if (loginBtn) {
                loginBtn.disabled = false;
                loginBtn.textContent = '🔓 로그인';
            }
            
            if (signupBtn) {
                signupBtn.disabled = false;
                signupBtn.textContent = '🚀 회원가입';
            }

            securityMonitor.logSecurity('info', '✅ 시스템 보안 잠금 해제');
            updateSecurityStatus('normal', '🔒 보안 상태 정상');
            
            showAdminStatus('✅ 보안 잠금이 해제되었습니다.', 'success');
        }

        function lockAccount(username, reason) {
            if (userData[username]) {
                userData[username].serverA.metadata.isLocked = true;
                userData[username].serverA.metadata.lockReason = reason;
                userData[username].serverB.authHistory.suspiciousActivity = true;
                lockedAccounts.add(username);
                
                securityMonitor.logSecurity('warning', `계정 잠금: ${username} (사유: ${reason})`);
            }
        }

        function unlockAccount(username) {
            if (userData[username]) {
                userData[username].serverA.metadata.isLocked = false;
                userData[username].serverA.metadata.lockReason = null;
                lockedAccounts.delete(username);
                
                securityMonitor.logSecurity('info', `계정 잠금 해제: ${username}`);
                updateUserList();
            }
        }

        function simulateAttack() {
            securityMonitor.logSecurity('warning', '🎯 해킹 시도 시뮬레이션 시작');
            
            // 가짜 공격 패턴들
            const attackPatterns = [
                { type: 'brute_force', target: 'admin', ip: '192.168.1.100' },
                { type: 'dictionary', target: 'user1', ip: '192.168.1.101' },
                { type: 'credential_stuffing', target: 'test', ip: '192.168.1.102' },
                { type: 'rapid_fire', target: 'admin', ip: '192.168.1.103' }
            ];

            const attack = attackPatterns[Math.floor(Math.random() * attackPatterns.length)];
            
            setTimeout(() => {
                securityMonitor.logSecurity('critical', `🔥 ${attack.type} 공격 탐지: ${attack.target} from ${attack.ip}`);
                
                // 공격 대응
                suspiciousIPs.add(attack.ip);
                
                if (attack.target in userData) {
                    lockAccount(attack.target, attack.type);
                }
                
                securityMonitor.triggerEmergencyResponse(attack.type, `${attack.target} from ${attack.ip}`);
            }, 1000);

            setTimeout(() => {
                securityMonitor.logSecurity('info', '시뮬레이션 완료');
            }, 3000);
        }

        // UI 함수들
        function showPage(pageId) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            if (pageId === 'user-site') {
                document.getElementById('nav-user-site').classList.add('active');
            } else if (pageId === 'server-admin') {
                document.getElementById('nav-server-admin').classList.add('active');
            } else if (pageId === 'security-monitoring') {
                document.getElementById('nav-security').classList.add('active');
            }
            
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            if (pageId === 'server-admin') {
                updateServerDisplay();
                updateUserList();
            } else if (pageId === 'security-monitoring') {
                updateSecurityLog();
            }
        }

        function switchAuthTab(tabName) {
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            if (tabName === 'signup') {
                document.getElementById('tab-signup').classList.add('active');
            } else {
                document.getElementById('tab-login').classList.add('active');
            }
            
            document.querySelectorAll('.auth-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-content`).classList.add('active');
            
            document.getElementById('signup-result').style.display = 'none';
            document.getElementById('login-result').innerHTML = '';
            document.getElementById('user-status').style.display = 'none';
        }

        // 회원가입 처리
        function handleSignup() {
            if (isLockdownMode) {
                showUserStatus('🚨 시스템이 보안 잠금 상태입니다. 잠시 후 다시 시도해주세요.', 'error');
                return;
            }

            const username = document.getElementById('signup-username').value;
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            
            if (!username || !password || !confirm) {
                showUserStatus('모든 필드를 입력해주세요.', 'error');
                return;
            }
            
            if (password !== confirm) {
                showUserStatus('패스워드가 일치하지 않습니다.', 'error');
                return;
            }
            
            if (userData[username]) {
                showUserStatus('이미 존재하는 사용자 ID입니다.', 'error');
                return;
            }
            
            if (password.length < 6) {
                showUserStatus('패스워드는 6자 이상이어야 합니다.', 'error');
                return;
            }
            
            const hashBlocks = generateAdvancedHash(username, password);
            const fullHash = hashBlocks.block1 + hashBlocks.block2 + hashBlocks.block3 + hashBlocks.block4;
            const splitData = splitHash(hashBlocks, username);
            
            userData[username] = splitData;
            
            Object.keys(serverStatus).forEach(server => {
                serverStatus[server] = true;
            });
            
            document.getElementById('signup-hash').textContent = fullHash;
            document.getElementById('signup-result').style.display = 'block';
            showUserStatus('회원가입이 완료되었습니다! 🎉', 'success');
            
            securityMonitor.logSecurity('info', `새 계정 생성: ${username}`);
            
            document.getElementById('signup-username').value = '';
            document.getElementById('signup-password').value = '';
            document.getElementById('signup-confirm').value = '';
        }

        // 로그인 처리 (보안 강화)
        function handleLogin() {
            if (isLockdownMode) {
                showLoginResult('🚨 시스템이 보안 잠금 상태입니다. 관리자에게 문의하세요.', false);
                return;
            }

            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const clientIP = generateRandomIP(); // 실제로는 클라이언트 IP를 가져와야 함
            
            if (!username || !password) {
                showLoginResult('사용자 ID와 패스워드를 모두 입력해주세요.', false);
                return;
            }

            // 계정 잠금 상태 확인
            if (lockedAccounts.has(username)) {
                showLoginResult('🔒 이 계정은 보안상 잠금되었습니다. 관리자에게 문의하세요.', false);
                securityMonitor.logSecurity('warning', `잠긴 계정 접근 시도: ${username} from ${clientIP}`);
                return;
            }

            // IP 차단 확인
            if (suspiciousIPs.has(clientIP)) {
                showLoginResult('🚫 차단된 IP 주소입니다.', false);
                securityMonitor.logSecurity('warning', `차단된 IP 접근 시도: ${clientIP}`);
                return;
            }
            
            if (!userData[username]) {
                const threat = securityMonitor.checkSuspiciousActivity(username, clientIP, false);
                if (threat === 'ip_attack' || threat === 'brute_force') {
                    securityMonitor.triggerEmergencyResponse(threat, `${username} from ${clientIP}`);
                }
                showLoginResult('존재하지 않는 사용자 ID입니다.', false);
                return;
            }
            
            const hashBlocks = generateAdvancedHash(username, password);
            const storedData = userData[username];
            
            let isValid = true;
            isValid &= storedData.serverA.hashFragment === hashBlocks.block1;
            isValid &= storedData.serverB.hashFragment === hashBlocks.block2;
            isValid &= storedData.serverC.hashFragment === hashBlocks.block3;
            isValid &= storedData.serverD.hashFragment === hashBlocks.block4.substr(0, 4);
            isValid &= storedData.serverE.hashFragment === hashBlocks.block4.substr(4, 4);
            
            // 보안 모니터링
            const threat = securityMonitor.checkSuspiciousActivity(username, clientIP, isValid);
            
            if (isValid) {
                // 로그인 성공
                storedData.serverB.authHistory.loginCount++;
                storedData.serverB.authHistory.lastLogin = new Date().toISOString();
                storedData.serverB.authHistory.failedAttempts = 0;
                storedData.serverB.authHistory.loginHistory.push({
                    timestamp: new Date().toISOString(),
                    success: true,
                    ip: clientIP,
                    threatLevel: threat
                });
                storedData.serverA.metadata.lastAccess = new Date().toISOString();
                
                showLoginResult(`환영합니다, ${username}님! 🎊<br>모든 서버에서 인증이 완료되었습니다.`, true);
                securityMonitor.logSecurity('info', `성공적인 로그인: ${username} from ${clientIP}`);
                
                if (threat !== 'normal') {
                    updateSecurityStatus('warning', `⚠️ 의심스러운 로그인 패턴 감지`);
                }
            } else {
                // 로그인 실패
                storedData.serverB.authHistory.failedAttempts++;
                storedData.serverB.authHistory.loginHistory.push({
                    timestamp: new Date().toISOString(),
                    success: false,
                    ip: clientIP,
                    threatLevel: threat
                });
                
                showLoginResult('로그인 실패! 패스워드가 올바르지 않습니다. 🚫', false);
                securityMonitor.logSecurity('warning', `로그인 실패: ${username} from ${clientIP} (실패 횟수: ${storedData.serverB.authHistory.failedAttempts})`);
                
                // 공격 대응
                if (threat === 'ip_attack' || threat === 'brute_force') {
                    securityMonitor.triggerEmergencyResponse(threat, `${username} from ${clientIP}`);
                } else if (threat === 'rapid_attempts') {
                    updateSecurityStatus('warning', '⚠️ 빠른 연속 시도 감지됨');
                }
            }
            
            document.getElementById('login-password').value = '';
        }

        // 서버 상태 업데이트
        function updateServerDisplay() {
            const servers = ['A', 'B', 'C', 'D', 'E'];
            
            servers.forEach(server => {
                const serverCard = document.getElementById(`server-${server}`);
                const statusElement = document.getElementById(`status-${server}`);
                const dataElement = document.getElementById(`data-${server}`);
                
                if (serverStatus[server]) {
                    if (isLockdownMode) {
                        serverCard.classList.add('lockdown');
                        serverCard.classList.remove('active', 'error');
                        statusElement.textContent = 'LOCKDOWN';
                        statusElement.className = 'server-status status-lockdown';
                    } else {
                        serverCard.classList.add('active');
                        serverCard.classList.remove('error', 'lockdown');
                        statusElement.textContent = 'ONLINE';
                        statusElement.className = 'server-status status-online';
                    }
                    
                    const serverKey = `server${server}`;
                    let serverData = [];
                    
                    Object.values(userData).forEach(user => {
                        if (user[serverKey]) {
                            serverData.push({
                                user: user.serverA?.metadata?.username || 'unknown',
                                data: user[serverKey]
                            });
                        }
                    });
                    
                    if (serverData.length > 0) {
                        dataElement.innerHTML = serverData.map(item => 
                            `<div style="margin-bottom: 10px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 5px;">
                                <strong>User: ${item.user}</strong>
                                ${item.data.metadata?.isLocked ? '<span style="color: #f44336;"> [LOCKED]</span>' : ''}
                                <br>
                                ${JSON.stringify(item.data, null, 2)}
                            </div>`
                        ).join('');
                    } else {
                        dataElement.textContent = '저장된 데이터가 없습니다.';
                    }
                } else {
                    serverCard.classList.remove('active', 'lockdown');
                    statusElement.textContent = 'OFFLINE';
                    statusElement.className = 'server-status status-offline';
                    dataElement.textContent = '서버 대기 중...';
                }
            });
        }

        // 사용자 목록 업데이트 (보안 상태 포함)
        function updateUserList() {
            const userListContent = document.getElementById('user-list-content');
            
            if (Object.keys(userData).length === 0) {
                userListContent.innerHTML = '등록된 사용자가 없습니다.';
                return;
            }
            
            const userItems = Object.entries(userData).map(([username, data]) => {
                const metadata = data.serverA?.metadata || {};
                const authHistory = data.serverB?.authHistory || {};
                const isLocked = metadata.isLocked || lockedAccounts.has(username);
                const isSuspicious = authHistory.suspiciousActivity;
                
                let itemClass = 'user-item';
                if (isLocked) itemClass += ' locked';
                else if (isSuspicious) itemClass += ' suspicious';
                
                return `
                    <div class="${itemClass}">
                        <div>
                            <strong>${username}</strong>
                            ${isLocked ? '<span style="color: #f44336;"> 🔒 [잠금됨]</span>' : ''}
                            ${isSuspicious && !isLocked ? '<span style="color: #FFC107;"> ⚠️ [의심]</span>' : ''}
                            <br>
                            <small>생성: ${new Date(metadata.created).toLocaleString('ko-KR')}</small><br>
                            <small>최근 접속: ${metadata.lastAccess ? new Date(metadata.lastAccess).toLocaleString('ko-KR') : '없음'}</small>
                            ${metadata.lockReason ? `<br><small style="color: #f44336;">잠금 사유: ${metadata.lockReason}</small>` : ''}
                        </div>
                        <div style="text-align: right;">
                            <div>로그인 횟수: ${authHistory.loginCount || 0}</div>
                            <div>실패 횟수: ${authHistory.failedAttempts || 0}</div>
                            ${isLocked ? '<button onclick="unlockAccount(\'' + username + '\')" style="background: #4CAF50; border: none; padding: 5px 10px; border-radius: 5px; color: white; font-size: 12px; margin-top: 5px;">잠금 해제</button>' : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            userListContent.innerHTML = userItems;
        }

        // 보안 로그 업데이트
        function updateSecurityLog() {
            const logContent = document.getElementById('security-log-content');
            
            if (securityLog.length === 0) {
                logContent.innerHTML = '<div class="log-entry log-info">[INFO] 보안 이벤트가 없습니다.</div>';
                return;
            }
            
            const logEntries = securityLog.slice(-50).reverse().map(entry => {
                const time = new Date(entry.timestamp).toLocaleTimeString('ko-KR');
                return `<div class="log-entry log-${entry.level}">[${time}] [${entry.level.toUpperCase()}] ${entry.message}</div>`;
            }).join('');
            
            logContent.innerHTML = logEntries;
            
            // 자동 스크롤
            logContent.scrollTop = 0;
        }

        // 서버 관리 기능들
        function refreshServers() {
            showAdminStatus('서버 상태를 새로고침하고 있습니다...', 'success');
            
            setTimeout(() => {
                updateServerDisplay();
                updateUserList();
                updateSecurityLog();
                showAdminStatus('모든 서버 상태가 업데이트되었습니다.', 'success');
                securityMonitor.logSecurity('info', '서버 상태 새로고침 완료');
            }, 1000);
        }

        function syncServers() {
            showAdminStatus('서버 간 데이터 동기화를 시작합니다...', 'success');
            
            setTimeout(() => {
                let syncCount = 0;
                Object.keys(userData).forEach(username => {
                    syncCount++;
                });
                
                showAdminStatus(`${syncCount}개 계정의 데이터 동기화가 완료되었습니다.`, 'success');
                securityMonitor.logSecurity('info', `데이터 동기화 완료: ${syncCount}개 계정`);
            }, 1500);
        }

        function clearAllData() {
            if (confirm('⚠️ 정말로 모든 데이터를 삭제하시겠습니까?\n이 작업은 되돌릴 수 없습니다.')) {
                userData = {};
                lockedAccounts.clear();
                suspiciousIPs.clear();
                securityLog = [];
                
                Object.keys(serverStatus).forEach(server => {
                    serverStatus[server] = false;
                });
                
                isLockdownMode = false;
                securityState = 'normal';
                
                updateServerDisplay();
                updateUserList();
                updateSecurityLog();
                showAdminStatus('모든 데이터가 삭제되었습니다.', 'error');
                
                document.getElementById('signup-result').style.display = 'none';
                document.getElementById('login-result').innerHTML = '';
                document.getElementById('security-alert').style.display = 'none';
                
                securityMonitor.logSecurity('warning', '시스템 데이터 전체 삭제됨');
            }
        }

        function clearSecurityLog() {
            securityLog = [];
            updateSecurityLog();
            showSecurityStatus('보안 로그가 지워졌습니다.', 'success');
        }

        // 상태 메시지 표시 함수들
        function showUserStatus(message, type) {
            const statusElement = document.getElementById('user-status');
            statusElement.textContent = message;
            statusElement.className = `status-message ${type}`;
            statusElement.style.display = 'block';
            
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 4000);
        }

        function showLoginResult(message, success) {
            const resultElement = document.getElementById('login-result');
            resultElement.innerHTML = `
                <div class="status-message ${success ? 'success' : 'error'}" style="margin-top: 15px;">
                    ${message}
                </div>
            `;
        }

        function showAdminStatus(message, type) {
            const statusElement = document.getElementById('admin-status');
            statusElement.innerHTML = `
                <div class="status-message ${type}">
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                statusElement.innerHTML = '';
            }, 3000);
        }

        function showSecurityStatus(message, type) {
            const statusElement = document.getElementById('security-status');
            statusElement.innerHTML = `
                <div class="status-message ${type}">
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                statusElement.innerHTML = '';
            }, 3000);
        }

        // 이벤트 리스너 설정
        function setupEventListeners() {
            // 네비게이션
            document.getElementById('nav-user-site').addEventListener('click', () => showPage('user-site'));
            document.getElementById('nav-server-admin').addEventListener('click', () => showPage('server-admin'));
            document.getElementById('nav-security').addEventListener('click', () => showPage('security-monitoring'));
            
            // 인증 탭
            document.getElementById('tab-signup').addEventListener('click', () => switchAuthTab('signup'));
            document.getElementById('tab-login').addEventListener('click', () => switchAuthTab('login'));
            
            // 회원가입/로그인 버튼
            document.getElementById('signup-btn').addEventListener('click', handleSignup);
            document.getElementById('login-btn').addEventListener('click', handleLogin);
            
            // 서버 관리 버튼
            document.getElementById('refresh-btn').addEventListener('click', refreshServers);
            document.getElementById('sync-btn').addEventListener('click', syncServers);
            document.getElementById('clear-btn').addEventListener('click', clearAllData);
            
            // 보안 관리 버튼
            document.getElementById('lockdown-btn').addEventListener('click', () => {
                if (isLockdownMode) {
                    exitSystemLockdown();
                } else {
                    if (confirm('⚠️ 시스템을 보안 잠금 상태로 전환하시겠습니까?')) {
                        enterSystemLockdown();
                    }
                }
            });

            // 보안 모니터링 버튼들
            document.getElementById('clear-log-btn').addEventListener('click', clearSecurityLog);
            document.getElementById('test-attack-btn').addEventListener('click', simulateAttack);
            document.getElementById('emergency-lockdown-btn').addEventListener('click', () => {
                if (confirm('🚨 긴급 보안 잠금을 활성화하시겠습니까?\n모든 사용자 접근이 차단됩니다.')) {
                    securityMonitor.logSecurity('critical', '🚨 관리자에 의한 긴급 잠금 활성화');
                    enterSystemLockdown();
                }
            });
            
            // Enter 키 이벤트
            const signupPassword = document.getElementById('signup-password');
            const signupConfirm = document.getElementById('signup-confirm');
            const loginPassword = document.getElementById('login-password');
            
            if (signupPassword) {
                signupPassword.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const confirmField = document.getElementById('signup-confirm');
                        if (confirmField) confirmField.focus();
                    }
                });
            }
            
            if (signupConfirm) {
                signupConfirm.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleSignup();
                });
            }
            
            if (loginPassword) {
                loginPassword.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleLogin();
                });
            }
        }

        // 주기적 보안 검사
        function startSecurityMonitoring() {
            setInterval(() => {
                if (isLockdownMode) return;
                
                // 의심스러운 IP 자동 해제 (10분 후)
                const tenMinutesAgo = Date.now() - 600000;
                let removedIPs = [];
                
                suspiciousIPs.forEach(ip => {
                    // 실제로는 IP별 마지막 시도 시간을 추적해야 함
                    if (Math.random() < 0.1) { // 10% 확률로 해제 (시뮬레이션)
                        suspiciousIPs.delete(ip);
                        removedIPs.push(ip);
                    }
                });
                
                if (removedIPs.length > 0) {
                    securityMonitor.logSecurity('info', `IP 차단 해제: ${removedIPs.join(', ')}`);
                }
                
                // 계정 자동 잠금 해제 검사
                lockedAccounts.forEach(username => {
                    if (userData[username]) {
                        const lockTime = new Date(userData[username].serverA.metadata.lastAccess).getTime();
                        if (Date.now() - lockTime > 300000) { // 5분 후 자동 해제 옵션
                            // 관리자 설정에 따라 자동 해제할 수 있음
                        }
                    }
                });

                // 서버 무결성 검사
                if (Math.random() < 0.05) { // 5% 확률로 무결성 검사
                    securityMonitor.logSecurity('info', '서버 무결성 검사 완료');
                }
                
            }, 30000); // 30초마다 실행
        }

        // 초기화 함수
        function initializeSystem() {
            setupEventListeners();
            startSecurityMonitoring();
            
            // 초기 보안 상태 설정
            updateSecurityStatus('normal', '🔒 보안 상태 정상');
            
            showAdminStatus('분산 패스워드 보안 시스템이 준비되었습니다. 🚀', 'success');
            securityMonitor.logSecurity('info', '🛡️ SecureAuth 보안 시스템 초기화 완료');
            securityMonitor.logSecurity('info', '침입 탐지 시스템 활성화됨');
            
            console.log('SecureAuth System with Enhanced Security initialized');
            console.log('ChaoticRNG hash algorithm loaded');
            console.log('5-Way split server architecture ready');
            console.log('Intrusion Detection System active');
        }

        // DOM 로드 완료 후 초기화
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeSystem);
        } else {
            initializeSystem();
        }
    </script>
</body>
</html>
