<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶„ì‚° íŒ¨ìŠ¤ì›Œë“œ ë³´ì•ˆ ì‹œìŠ¤í…œ - ì¹¨ì… íƒì§€ ê°•í™”</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea, #764ba2);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            color: white;
        }

        .navbar {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 1.5em;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-link {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: #4CAF50;
        }

        /* ë³´ì•ˆ ìƒíƒœ í‘œì‹œ */
        .security-alert {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            z-index: 999;
            transition: all 0.3s ease;
            display: none;
        }

        .security-alert.normal {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid #4CAF50;
            color: #4CAF50;
        }

        .security-alert.warning {
            background: rgba(255, 193, 7, 0.3);
            border: 1px solid #FFC107;
            color: #FFC107;
            animation: pulse 2s infinite;
        }

        .security-alert.danger {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid #f44336;
            color: #f44336;
            animation: alert-blink 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }

        @keyframes alert-blink {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .main-content {
            margin-top: 80px;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: calc(100vh - 80px);
            align-items: center;
        }

        .page {
            display: none;
            width: 100%;
            max-width: 1000px;
        }

        .page.active {
            display: block;
        }

        /* ì‚¬ìš©ì ì‚¬ì´íŠ¸ ìŠ¤íƒ€ì¼ */
        .user-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 500px;
            margin: 0 auto;
        }

        .site-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #e0e0e0;
        }

        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus, input[type="password"]:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        input.locked {
            background: rgba(244, 67, 54, 0.2) !important;
            border: 1px solid #f44336;
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn:disabled {
            background: rgba(128, 128, 128, 0.5);
            cursor: not-allowed;
            transform: none;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .auth-tab.active {
            border-bottom-color: #667eea;
            background: rgba(255, 255, 255, 0.1);
        }

        .auth-content {
            display: none;
        }

        .auth-content.active {
            display: block;
        }

        /* ì„œë²„ ê´€ë¦¬ ìŠ¤íƒ€ì¼ */
        .server-container {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .server-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .server-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .server-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .server-card.active {
            border-color: #4CAF50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.3);
        }

        .server-card.error {
            border-color: #f44336;
            box-shadow: 0 0 20px rgba(244, 67, 54, 0.3);
        }

        .server-card.lockdown {
            border-color: #ff9800;
            box-shadow: 0 0 20px rgba(255, 152, 0, 0.5);
            background: rgba(255, 152, 0, 0.1);
            animation: security-pulse 2s infinite;
        }

        @keyframes security-pulse {
            0% { box-shadow: 0 0 20px rgba(255, 152, 0, 0.3); }
            50% { box-shadow: 0 0 30px rgba(255, 152, 0, 0.7); }
            100% { box-shadow: 0 0 20px rgba(255, 152, 0, 0.3); }
        }

        .server-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .server-name {
            font-size: 1.3em;
            font-weight: bold;
        }

        .server-status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .status-online {
            background: rgba(76, 175, 80, 0.3);
            color: #4CAF50;
        }

        .status-offline {
            background: rgba(244, 67, 54, 0.3);
            color: #f44336;
        }

        .status-lockdown {
            background: rgba(255, 152, 0, 0.3);
            color: #ff9800;
            animation: status-blink 1s infinite;
        }

        @keyframes status-blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .server-info {
            color: #b0b0b0;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .server-data {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }

        .server-controls {
            text-align: center;
            margin-top: 30px;
        }

        .control-btn {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            border: none;
            padding: 10px 25px;
            border-radius: 20px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .control-btn.danger {
            background: linear-gradient(45deg, #ff7675, #d63031);
        }

        .control-btn.warning {
            background: linear-gradient(45deg, #fdcb6e, #e17055);
        }

        .status-message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 600;
        }

        .success {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid #4CAF50;
        }

        .error {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid #f44336;
        }

        .warning {
            background: rgba(255, 193, 7, 0.3);
            border: 1px solid #FFC107;
            color: #FFC107;
        }

        .hash-display {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            line-height: 1.5;
        }

        .user-list {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-bottom: 5px;
        }

        .user-item:last-child {
            border-bottom: none;
        }

        .user-item.locked {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
        }

        .user-item.suspicious {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid #FFC107;
        }

        .security-log {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-entry {
            font-family: monospace;
            font-size: 11px;
            padding: 5px;
            margin: 2px 0;
            border-radius: 3px;
        }

        .log-info { background: rgba(33, 150, 243, 0.2); }
        .log-warning { background: rgba(255, 193, 7, 0.2); }
        .log-error { background: rgba(244, 67, 54, 0.2); }
        .log-critical { background: rgba(156, 39, 176, 0.3); animation: log-flash 2s infinite; }

        @keyframes log-flash {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .nav-links {
                width: 100%;
                justify-content: center;
            }
            
            .main-content {
                margin-top: 120px;
                padding: 10px;
            }
            
            .user-container, .server-container {
                padding: 20px;
            }
            
            .server-grid {
                grid-template-columns: 1fr;
            }

            .security-alert {
                right: 10px;
                top: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- ë³´ì•ˆ ìƒíƒœ ì•Œë¦¼ -->
    <div id="security-alert" class="security-alert">
        <span id="security-status">ğŸ”’ ë³´ì•ˆ ìƒíƒœ ì •ìƒ</span>
    </div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">ğŸ›¡ï¸ SecureAuth System</div>
            <div class="nav-links">
                <div class="nav-link active" id="nav-user-site">ì‚¬ìš©ì ì‚¬ì´íŠ¸</div>
                <div class="nav-link" id="nav-server-admin">ì„œë²„ ê´€ë¦¬</div>
                <div class="nav-link" id="nav-security">ë³´ì•ˆ ëª¨ë‹ˆí„°ë§</div>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <!-- ì‚¬ìš©ì ì‚¬ì´íŠ¸ í˜ì´ì§€ -->
        <div id="user-site" class="page active">
            <div class="user-container">
                <h1 class="site-title">ğŸŒŸ SecureAuth</h1>
                <p style="text-align: center; margin-bottom: 30px; color: #b0b0b0;">
                    ì°¨ì„¸ëŒ€ ë¶„ì‚° ë³´ì•ˆ ì¸ì¦ ì‹œìŠ¤í…œ - ì¹¨ì… íƒì§€ ê°•í™”
                </p>
                
                <div class="auth-tabs">
                    <div class="auth-tab active" id="tab-signup">íšŒì›ê°€ì…</div>
                    <div class="auth-tab" id="tab-login">ë¡œê·¸ì¸</div>
                </div>
                
                <div id="signup-content" class="auth-content active">
                    <div class="form-group">
                        <label for="signup-username">ì‚¬ìš©ì ID</label>
                        <input type="text" id="signup-username" placeholder="ì›í•˜ëŠ” IDë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="form-group">
                        <label for="signup-password">íŒ¨ìŠ¤ì›Œë“œ</label>
                        <input type="password" id="signup-password" placeholder="ì•ˆì „í•œ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="form-group">
                        <label for="signup-confirm">íŒ¨ìŠ¤ì›Œë“œ í™•ì¸</label>
                        <input type="password" id="signup-confirm" placeholder="íŒ¨ìŠ¤ì›Œë“œë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <button class="btn" id="signup-btn">ğŸš€ íšŒì›ê°€ì…</button>
                    
                    <div id="signup-result" class="hash-display" style="display:none;">
                        <strong>âœ… ê³„ì • ìƒì„± ì™„ë£Œ!</strong><br>
                        ìƒì„±ëœ 128ë¹„íŠ¸ í•´ì‹œ: <span id="signup-hash"></span><br>
                        <small>íŒ¨ìŠ¤ì›Œë“œê°€ 5ê°œ ì„œë²„ì— ì•ˆì „í•˜ê²Œ ë¶„ì‚° ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</small>
                    </div>
                </div>
                
                <div id="login-content" class="auth-content">
                    <div class="form-group">
                        <label for="login-username">ì‚¬ìš©ì ID</label>
                        <input type="text" id="login-username" placeholder="IDë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="form-group">
                        <label for="login-password">íŒ¨ìŠ¤ì›Œë“œ</label>
                        <input type="password" id="login-password" placeholder="íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <button class="btn" id="login-btn">ğŸ”“ ë¡œê·¸ì¸</button>
                    
                    <div id="login-result"></div>
                </div>
                
                <div id="user-status" class="status-message" style="display:none;"></div>
            </div>
        </div>

        <!-- ì„œë²„ ê´€ë¦¬ í˜ì´ì§€ -->
        <div id="server-admin" class="page">
            <div class="server-container">
                <h1 class="server-title">ğŸ–¥ï¸ ë¶„ì‚° íŒ¨ìŠ¤ì›Œë“œ ì €ì¥ ì„œë²„ ê´€ë¦¬</h1>
                
                <div class="server-grid">
                    <div class="server-card" id="server-A">
                        <div class="server-header">
                            <div class="server-name">Server A - Primary</div>
                            <div class="server-status status-offline" id="status-A">OFFLINE</div>
                        </div>
                        <div class="server-info">32ë¹„íŠ¸ í•´ì‹œ + ì‚¬ìš©ì ë©”íƒ€ë°ì´í„°</div>
                        <div class="server-data" id="data-A">ì„œë²„ ëŒ€ê¸° ì¤‘...</div>
                    </div>
                    
                    <div class="server-card" id="server-B">
                        <div class="server-header">
                            <div class="server-name">Server B - Auth</div>
                            <div class="server-status status-offline" id="status-B">OFFLINE</div>
                        </div>
                        <div class="server-info">32ë¹„íŠ¸ í•´ì‹œ + ì¸ì¦ ì´ë ¥</div>
                        <div class="server-data" id="data-B">ì„œë²„ ëŒ€ê¸° ì¤‘...</div>
                    </div>
                    
                    <div class="server-card" id="server-C">
                        <div class="server-header">
                            <div class="server-name">Server C - Context</div>
                            <div class="server-status status-offline" id="status-C">OFFLINE</div>
                        </div>
                        <div class="server-info">32ë¹„íŠ¸ í•´ì‹œ + ì»¨í…ìŠ¤íŠ¸ ì •ë³´</div>
                        <div class="server-data" id="data-C">ì„œë²„ ëŒ€ê¸° ì¤‘...</div>
                    </div>
                    
                    <div class="server-card" id="server-D">
                        <div class="server-header">
                            <div class="server-name">Server D - Verification</div>
                            <div class="server-status status-offline" id="status-D">OFFLINE</div>
                        </div>
                        <div class="server-info">16ë¹„íŠ¸ í•´ì‹œ + ê²€ì¦ ë°ì´í„°</div>
                        <div class="server-data" id="data-D">ì„œë²„ ëŒ€ê¸° ì¤‘...</div>
                    </div>
                    
                    <div class="server-card" id="server-E">
                        <div class="server-header">
                            <div class="server-name">Server E - Recovery</div>
                            <div class="server-status status-offline" id="status-E">OFFLINE</div>
                        </div>
                        <div class="server-info">16ë¹„íŠ¸ í•´ì‹œ + ë³µêµ¬ ì‹œë“œ</div>
                        <div class="server-data" id="data-E">ì„œë²„ ëŒ€ê¸° ì¤‘...</div>
                    </div>
                </div>
                
                <div class="user-list">
                    <h3>ğŸ“‹ ë“±ë¡ëœ ì‚¬ìš©ì ëª©ë¡</h3>
                    <div id="user-list-content">ë“±ë¡ëœ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤.</div>
                </div>
                
                <div class="server-controls">
                    <button class="control-btn" id="refresh-btn">ğŸ”„ ì„œë²„ ìƒíƒœ ìƒˆë¡œê³ ì¹¨</button>
                    <button class="control-btn" id="sync-btn">ğŸ”„ ì„œë²„ ë™ê¸°í™”</button>
                    <button class="control-btn warning" id="lockdown-btn">ğŸ”’ ë³´ì•ˆ ì ê¸ˆ</button>
                    <button class="control-btn danger" id="clear-btn">ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì‚­ì œ</button>
                </div>
                
                <div id="admin-status"></div>
            </div>
        </div>

        <!-- ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ í˜ì´ì§€ -->
        <div id="security-monitoring" class="page">
            <div class="server-container">
                <h1 class="server-title">ğŸ›¡ï¸ ë³´ì•ˆ ì¹¨ì… íƒì§€ ì‹œìŠ¤í…œ</h1>
                
                <div class="security-log">
                    <h3>ğŸ“Š ì‹¤ì‹œê°„ ë³´ì•ˆ ë¡œê·¸</h3>
                    <div id="security-log-content">
                        <div class="log-entry log-info">[INFO] ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
                    </div>
                </div>
                
                <div class="server-controls">
                    <button class="control-btn" id="clear-log-btn">ğŸ“ ë¡œê·¸ ì§€ìš°ê¸°</button>
                    <button class="control-btn warning" id="test-attack-btn">ğŸ¯ í•´í‚¹ ì‹œë„ ì‹œë®¬ë ˆì´ì…˜</button>
                    <button class="control-btn danger" id="emergency-lockdown-btn">ğŸš¨ ê¸´ê¸‰ ì ê¸ˆ</button>
                </div>
                
                <div id="security-status"></div>
            </div>
        </div>
    </div>

    <script>
        // ê¸€ë¡œë²Œ ë³€ìˆ˜ë“¤
        let userData = {};
        let serverStatus = {
            A: false, B: false, C: false, D: false, E: false
        };
        let securityState = 'normal'; // normal, warning, danger
        let isLockdownMode = false;
        let lockedAccounts = new Set();
        let suspiciousIPs = new Set();
        let securityLog = [];

        // ë³´ì•ˆ ì´ë²¤íŠ¸ íƒ€ì… ì •ì˜
        const SecurityEvents = {
            NORMAL: 'normal',
            SUSPICIOUS: 'suspicious',
            ATTACK: 'attack',
            LOCKDOWN: 'lockdown'
        };

        // ChaoticRNG í´ë˜ìŠ¤
        class ChaoticRNG {
            constructor(seed, key = 314159, r = 3.99) {
                this.x = (seed % 4294967295) / 4294967295.0;
                this.k = (key % 4294967295) / 4294967295.0;
                this.r = r;
                this.i = 0;
                this.keyMod = key % 101;
            }
            
            next() {
                this.x = this.r * this.x * (1.0 - this.x);
                let y = (this.x + this.k + ((this.i % 251) / 997.0)) % 1.0;
                let val = Math.floor(y * (Math.pow(2, 53) - 1));
                this.x = (this.x + y + this.keyMod) % 1.0;
                this.i++;
                return val;
            }
        }

        // í•´í‚¹ ì‹œë„ íƒì§€ í´ë˜ìŠ¤
        class SecurityMonitor {
            constructor() {
                this.suspiciousAttempts = {};
                this.ipAttempts = {};
                this.lastAttempts = {};
                this.threshold = {
                    maxFailedAttempts: 3,
                    timeWindow: 60000, // 1ë¶„
                    suspiciousInterval: 5000, // 5ì´ˆ ì´ë‚´ ë°˜ë³µ ì‹œë„
                    maxIPAttempts: 5
                };
            }

            checkSuspiciousActivity(username, ip, success) {
                const now = Date.now();
                const userKey = `${username}_${ip}`;
                
                // IPë³„ ì‹œë„ íšŸìˆ˜ ì¶”ì 
                if (!this.ipAttempts[ip]) {
                    this.ipAttempts[ip] = [];
                }
                this.ipAttempts[ip].push(now);
                
                // ì‹œê°„ ìœˆë„ìš° ë°–ì˜ ì‹œë„ ì œê±°
                this.ipAttempts[ip] = this.ipAttempts[ip].filter(time => 
                    now - time < this.threshold.timeWindow
                );

                // ì‚¬ìš©ìë³„ ì‹¤íŒ¨ ì‹œë„ ì¶”ì 
                if (!success) {
                    if (!this.suspiciousAttempts[userKey]) {
                        this.suspiciousAttempts[userKey] = [];
                    }
                    this.suspiciousAttempts[userKey].push(now);
                    
                    // ì‹œê°„ ìœˆë„ìš° ë°–ì˜ ì‹œë„ ì œê±°
                    this.suspiciousAttempts[userKey] = this.suspiciousAttempts[userKey].filter(time => 
                        now - time < this.threshold.timeWindow
                    );
                }

                // ë§ˆì§€ë§‰ ì‹œë„ ì‹œê°„ í™•ì¸
                if (this.lastAttempts[userKey]) {
                    const timeDiff = now - this.lastAttempts[userKey];
                    if (timeDiff < this.threshold.suspiciousInterval) {
                        this.logSecurity('warning', `ë¹ ë¥¸ ì—°ì† ì‹œë„ ê°ì§€: ${username} from ${ip}`);
                        return 'rapid_attempts';
                    }
                }
                this.lastAttempts[userKey] = now;

                // ê³µê²© íƒì§€ ë¡œì§
                if (this.ipAttempts[ip].length > this.threshold.maxIPAttempts) {
                    this.logSecurity('critical', `IP ê¸°ë°˜ ê³µê²© íƒì§€: ${ip} (${this.ipAttempts[ip].length} ì‹œë„)`);
                    return 'ip_attack';
                }

                if (!success && this.suspiciousAttempts[userKey] && 
                    this.suspiciousAttempts[userKey].length >= this.threshold.maxFailedAttempts) {
                    this.logSecurity('critical', `ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²© íƒì§€: ${username} from ${ip}`);
                    return 'brute_force';
                }

                return 'normal';
            }

            logSecurity(level, message) {
                const timestamp = new Date().toISOString();
                const entry = { timestamp, level, message };
                securityLog.push(entry);
                
                // ë¡œê·¸ê°€ ë„ˆë¬´ ë§ì•„ì§€ë©´ ì˜¤ë˜ëœ í•­ëª© ì œê±°
                if (securityLog.length > 100) {
                    securityLog.shift();
                }
                
                updateSecurityLog();
                console.log(`[SECURITY ${level.toUpperCase()}] ${message}`);
            }

            triggerEmergencyResponse(threatType, details) {
                this.logSecurity('critical', `ğŸš¨ ê¸´ê¸‰ ë³´ì•ˆ ëŒ€ì‘ ë°œë™: ${threatType} - ${details}`);
                
                // ëª¨ë“  ì„œë²„ë¥¼ ë³´ì•ˆ ì ê¸ˆ ìƒíƒœë¡œ ì „í™˜
                enterSystemLockdown();
                
                // ê´€ë ¨ ê³„ì • ì ê¸ˆ
                if (details.includes('from')) {
                    const parts = details.split(' ');
                    const username = parts[0];
                    lockAccount(username, threatType);
                }
                
                // ì˜ì‹¬ìŠ¤ëŸ¬ìš´ IP ì°¨ë‹¨
                if (details.includes('from')) {
                    const ip = details.split('from ')[1].split(' ')[0];
                    suspiciousIPs.add(ip);
                    this.logSecurity('warning', `IP ì£¼ì†Œ ì°¨ë‹¨: ${ip}`);
                }

                updateSecurityStatus('danger', `ğŸš¨ ë³´ì•ˆ ìœ„í˜‘ íƒì§€: ${threatType}`);
            }
        }

        const securityMonitor = new SecurityMonitor();

        // í•´ì‹œ í•¨ìˆ˜ë“¤
        function customHash(input, seed) {
            let rng = new ChaoticRNG(seed);
            let hash = 0;
            
            for (let i = 0; i < input.length; i++) {
                let char = input.charCodeAt(i);
                hash = (hash + char * rng.next()) % (Math.pow(2, 53) - 1);
            }
            
            for (let round = 0; round < 5; round++) {
                hash = (hash * rng.next()) % (Math.pow(2, 53) - 1);
            }
            
            return hash;
        }

        function generateAdvancedHash(username, password) {
            let seedStr = username + ":" + password;
            let seed = 0;
            
            for (let i = 0; i < seedStr.length; i++) {
                seed = ((seed << 5) - seed + seedStr.charCodeAt(i)) & 0xffffffff;
            }
            
            let hash1 = customHash(password + username, seed);
            let hash2 = customHash(username + password, seed ^ 0xABCDEF);
            let hash3 = customHash(password + "salt1" + username, seed ^ 0x123456);
            let hash4 = customHash(username + "salt2" + password, seed ^ 0x789ABC);
            
            return {
                block1: (hash1 % Math.pow(2, 32)).toString(16).padStart(8, '0'),
                block2: (hash2 % Math.pow(2, 32)).toString(16).padStart(8, '0'),
                block3: (hash3 % Math.pow(2, 32)).toString(16).padStart(8, '0'),
                block4: (hash4 % Math.pow(2, 32)).toString(16).padStart(8, '0')
            };
        }

        function splitHash(hashBlocks, username) {
            const now = new Date().toISOString();
            const ip = generateRandomIP();
            
            return {
                serverA: {
                    hashFragment: hashBlocks.block1,
                    metadata: {
                        username: username,
                        created: now,
                        lastAccess: now,
                        userLevel: "standard",
                        isLocked: false,
                        lockReason: null
                    }
                },
                serverB: {
                    hashFragment: hashBlocks.block2,
                    authHistory: {
                        loginCount: 0,
                        lastLogin: null,
                        failedAttempts: 0,
                        loginHistory: [],
                        suspiciousActivity: false
                    }
                },
                serverC: {
                    hashFragment: hashBlocks.block3,
                    context: {
                        ipAddress: ip,
                        userAgent: "SecureSystem/2.0",
                        sessionId: Math.random().toString(36).substr(2, 12),
                        location: "Seoul, KR",
                        securityLevel: "normal"
                    }
                },
                serverD: {
                    hashFragment: hashBlocks.block4.substr(0, 4),
                    verification: {
                        checksum: hashBlocks.block4.substr(4, 4),
                        integrity: true,
                        lastVerified: now,
                        securityEvents: []
                    }
                },
                serverE: {
                    hashFragment: hashBlocks.block4.substr(4, 4),
                    recovery: {
                        seed: Math.random().toString(36).substr(2, 10),
                        backupHash: hashBlocks.block1.substr(0, 4),
                        recoveryKey: Math.random().toString(36).substr(2, 8),
                        backupLocked: false
                    }
                }
            };
        }

        // ë³´ì•ˆ í•¨ìˆ˜ë“¤
        function generateRandomIP() {
            return `192.168.1.${Math.floor(Math.random() * 255)}`;
        }

        function updateSecurityStatus(level, message) {
            const alertElement = document.getElementById('security-alert');
            const statusElement = document.getElementById('security-status');
            
            alertElement.className = `security-alert ${level}`;
            statusElement.textContent = message;
            alertElement.style.display = 'block';
            
            securityState = level;
            
            if (level === 'danger') {
                // ìœ„í—˜ ìƒíƒœì¼ ë•ŒëŠ” ê³„ì† í‘œì‹œ
                clearTimeout(window.securityTimeout);
            } else {
                // ì¼ë°˜/ê²½ê³  ìƒíƒœëŠ” 5ì´ˆ í›„ ìˆ¨ê¹€
                clearTimeout(window.securityTimeout);
                window.securityTimeout = setTimeout(() => {
                    if (securityState !== 'danger') {
                        alertElement.style.display = 'none';
                    }
                }, 5000);
            }
        }

        function enterSystemLockdown() {
            isLockdownMode = true;
            
            // ëª¨ë“  ì„œë²„ë¥¼ ì ê¸ˆ ìƒíƒœë¡œ ë³€ê²½
            Object.keys(serverStatus).forEach(server => {
                if (serverStatus[server]) {
                    const serverCard = document.getElementById(`server-${server}`);
                    const statusElement = document.getElementById(`status-${server}`);
                    
                    serverCard.classList.add('lockdown');
                    statusElement.textContent = 'LOCKDOWN';
                    statusElement.className = 'server-status status-lockdown';
                }
            });

            // ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ì ê¸ˆ
            const loginBtn = document.getElementById('login-btn');
            const signupBtn = document.getElementById('signup-btn');
            
            if (loginBtn) {
                loginBtn.disabled = true;
                loginBtn.textContent = 'ğŸ”’ ì‹œìŠ¤í…œ ì ê¸ˆ ì¤‘';
            }
            
            if (signupBtn) {
                signupBtn.disabled = true;
                signupBtn.textContent = 'ğŸ”’ ì‹œìŠ¤í…œ ì ê¸ˆ ì¤‘';
            }

            securityMonitor.logSecurity('critical', 'ğŸ”’ ì‹œìŠ¤í…œ ì „ì²´ ë³´ì•ˆ ì ê¸ˆ ëª¨ë“œ ì§„ì…');
            updateSecurityStatus('danger', 'ğŸš¨ ë³´ì•ˆ ì ê¸ˆ ëª¨ë“œ - ëª¨ë“  ì¸ì¦ ì°¨ë‹¨ë¨');
            
            showAdminStatus('ğŸš¨ ê¸´ê¸‰ ë³´ì•ˆ ì ê¸ˆì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ëª¨ë“  ì„œë²„ê°€ ë³´ì•ˆ ìƒíƒœë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.', 'error');
        }

        function exitSystemLockdown() {
            if (!confirm('âš ï¸ ì •ë§ë¡œ ë³´ì•ˆ ì ê¸ˆì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nëª¨ë“  ìœ„í˜‘ì´ ì œê±°ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.')) {
                return;
            }

            isLockdownMode = false;
            
            // ì„œë²„ ìƒíƒœ ë³µêµ¬
            Object.keys(serverStatus).forEach(server => {
                if (serverStatus[server]) {
                    const serverCard = document.getElementById(`server-${server}`);
                    const statusElement = document.getElementById(`status-${server}`);
                    
                    serverCard.classList.remove('lockdown');
                    statusElement.textContent = 'ONLINE';
                    statusElement.className = 'server-status status-online';
                }
            });

            // ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ë³µêµ¬
            const loginBtn = document.getElementById('login-btn');
            const signupBtn = document.getElementById('signup-btn');
            
            if (loginBtn) {
                loginBtn.disabled = false;
                loginBtn.textContent = 'ğŸ”“ ë¡œê·¸ì¸';
            }
            
            if (signupBtn) {
                signupBtn.disabled = false;
                signupBtn.textContent = 'ğŸš€ íšŒì›ê°€ì…';
            }

            securityMonitor.logSecurity('info', 'âœ… ì‹œìŠ¤í…œ ë³´ì•ˆ ì ê¸ˆ í•´ì œ');
            updateSecurityStatus('normal', 'ğŸ”’ ë³´ì•ˆ ìƒíƒœ ì •ìƒ');
            
            showAdminStatus('âœ… ë³´ì•ˆ ì ê¸ˆì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }

        function lockAccount(username, reason) {
            if (userData[username]) {
                userData[username].serverA.metadata.isLocked = true;
                userData[username].serverA.metadata.lockReason = reason;
                userData[username].serverB.authHistory.suspiciousActivity = true;
                lockedAccounts.add(username);
                
                securityMonitor.logSecurity('warning', `ê³„ì • ì ê¸ˆ: ${username} (ì‚¬ìœ : ${reason})`);
            }
        }

        function unlockAccount(username) {
            if (userData[username]) {
                userData[username].serverA.metadata.isLocked = false;
                userData[username].serverA.metadata.lockReason = null;
                lockedAccounts.delete(username);
                
                securityMonitor.logSecurity('info', `ê³„ì • ì ê¸ˆ í•´ì œ: ${username}`);
                updateUserList();
            }
        }

        function simulateAttack() {
            securityMonitor.logSecurity('warning', 'ğŸ¯ í•´í‚¹ ì‹œë„ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘');
            
            // ê°€ì§œ ê³µê²© íŒ¨í„´ë“¤
            const attackPatterns = [
                { type: 'brute_force', target: 'admin', ip: '192.168.1.100' },
                { type: 'dictionary', target: 'user1', ip: '192.168.1.101' },
                { type: 'credential_stuffing', target: 'test', ip: '192.168.1.102' },
                { type: 'rapid_fire', target: 'admin', ip: '192.168.1.103' }
            ];

            const attack = attackPatterns[Math.floor(Math.random() * attackPatterns.length)];
            
            setTimeout(() => {
                securityMonitor.logSecurity('critical', `ğŸ”¥ ${attack.type} ê³µê²© íƒì§€: ${attack.target} from ${attack.ip}`);
                
                // ê³µê²© ëŒ€ì‘
                suspiciousIPs.add(attack.ip);
                
                if (attack.target in userData) {
                    lockAccount(attack.target, attack.type);
                }
                
                securityMonitor.triggerEmergencyResponse(attack.type, `${attack.target} from ${attack.ip}`);
            }, 1000);

            setTimeout(() => {
                securityMonitor.logSecurity('info', 'ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ');
            }, 3000);
        }

        // UI í•¨ìˆ˜ë“¤
        function showPage(pageId) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            if (pageId === 'user-site') {
                document.getElementById('nav-user-site').classList.add('active');
            } else if (pageId === 'server-admin') {
                document.getElementById('nav-server-admin').classList.add('active');
            } else if (pageId === 'security-monitoring') {
                document.getElementById('nav-security').classList.add('active');
            }
            
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            if (pageId === 'server-admin') {
                updateServerDisplay();
                updateUserList();
            } else if (pageId === 'security-monitoring') {
                updateSecurityLog();
            }
        }

        function switchAuthTab(tabName) {
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            if (tabName === 'signup') {
                document.getElementById('tab-signup').classList.add('active');
            } else {
                document.getElementById('tab-login').classList.add('active');
            }
            
            document.querySelectorAll('.auth-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-content`).classList.add('active');
            
            document.getElementById('signup-result').style.display = 'none';
            document.getElementById('login-result').innerHTML = '';
            document.getElementById('user-status').style.display = 'none';
        }

        // íšŒì›ê°€ì… ì²˜ë¦¬
        function handleSignup() {
            if (isLockdownMode) {
                showUserStatus('ğŸš¨ ì‹œìŠ¤í…œì´ ë³´ì•ˆ ì ê¸ˆ ìƒíƒœì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            const username = document.getElementById('signup-username').value;
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            
            if (!username || !password || !confirm) {
                showUserStatus('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            if (password !== confirm) {
                showUserStatus('íŒ¨ìŠ¤ì›Œë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            if (userData[username]) {
                showUserStatus('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ì IDì…ë‹ˆë‹¤.', 'error');
                return;
            }
            
            if (password.length < 6) {
                showUserStatus('íŒ¨ìŠ¤ì›Œë“œëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error');
                return;
            }
            
            const hashBlocks = generateAdvancedHash(username, password);
            const fullHash = hashBlocks.block1 + hashBlocks.block2 + hashBlocks.block3 + hashBlocks.block4;
            const splitData = splitHash(hashBlocks, username);
            
            userData[username] = splitData;
            
            Object.keys(serverStatus).forEach(server => {
                serverStatus[server] = true;
            });
            
            document.getElementById('signup-hash').textContent = fullHash;
            document.getElementById('signup-result').style.display = 'block';
            showUserStatus('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰', 'success');
            
            securityMonitor.logSecurity('info', `ìƒˆ ê³„ì • ìƒì„±: ${username}`);
            
            document.getElementById('signup-username').value = '';
            document.getElementById('signup-password').value = '';
            document.getElementById('signup-confirm').value = '';
        }

        // ë¡œê·¸ì¸ ì²˜ë¦¬ (ë³´ì•ˆ ê°•í™”)
        function handleLogin() {
            if (isLockdownMode) {
                showLoginResult('ğŸš¨ ì‹œìŠ¤í…œì´ ë³´ì•ˆ ì ê¸ˆ ìƒíƒœì…ë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.', false);
                return;
            }

            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const clientIP = generateRandomIP(); // ì‹¤ì œë¡œëŠ” í´ë¼ì´ì–¸íŠ¸ IPë¥¼ ê°€ì ¸ì™€ì•¼ í•¨
            
            if (!username || !password) {
                showLoginResult('ì‚¬ìš©ì IDì™€ íŒ¨ìŠ¤ì›Œë“œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', false);
                return;
            }

            // ê³„ì • ì ê¸ˆ ìƒíƒœ í™•ì¸
            if (lockedAccounts.has(username)) {
                showLoginResult('ğŸ”’ ì´ ê³„ì •ì€ ë³´ì•ˆìƒ ì ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.', false);
                securityMonitor.logSecurity('warning', `ì ê¸´ ê³„ì • ì ‘ê·¼ ì‹œë„: ${username} from ${clientIP}`);
                return;
            }

            // IP ì°¨ë‹¨ í™•ì¸
            if (suspiciousIPs.has(clientIP)) {
                showLoginResult('ğŸš« ì°¨ë‹¨ëœ IP ì£¼ì†Œì…ë‹ˆë‹¤.', false);
                securityMonitor.logSecurity('warning', `ì°¨ë‹¨ëœ IP ì ‘ê·¼ ì‹œë„: ${clientIP}`);
                return;
            }
            
            if (!userData[username]) {
                const threat = securityMonitor.checkSuspiciousActivity(username, clientIP, false);
                if (threat === 'ip_attack' || threat === 'brute_force') {
                    securityMonitor.triggerEmergencyResponse(threat, `${username} from ${clientIP}`);
                }
                showLoginResult('ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì IDì…ë‹ˆë‹¤.', false);
                return;
            }
            
            const hashBlocks = generateAdvancedHash(username, password);
            const storedData = userData[username];
            
            let isValid = true;
            isValid &= storedData.serverA.hashFragment === hashBlocks.block1;
            isValid &= storedData.serverB.hashFragment === hashBlocks.block2;
            isValid &= storedData.serverC.hashFragment === hashBlocks.block3;
            isValid &= storedData.serverD.hashFragment === hashBlocks.block4.substr(0, 4);
            isValid &= storedData.serverE.hashFragment === hashBlocks.block4.substr(4, 4);
            
            // ë³´ì•ˆ ëª¨ë‹ˆí„°ë§
            const threat = securityMonitor.checkSuspiciousActivity(username, clientIP, isValid);
            
            if (isValid) {
                // ë¡œê·¸ì¸ ì„±ê³µ
                storedData.serverB.authHistory.loginCount++;
                storedData.serverB.authHistory.lastLogin = new Date().toISOString();
                storedData.serverB.authHistory.failedAttempts = 0;
                storedData.serverB.authHistory.loginHistory.push({
                    timestamp: new Date().toISOString(),
                    success: true,
                    ip: clientIP,
                    threatLevel: threat
                });
                storedData.serverA.metadata.lastAccess = new Date().toISOString();
                
                showLoginResult(`í™˜ì˜í•©ë‹ˆë‹¤, ${username}ë‹˜! ğŸŠ<br>ëª¨ë“  ì„œë²„ì—ì„œ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`, true);
                securityMonitor.logSecurity('info', `ì„±ê³µì ì¸ ë¡œê·¸ì¸: ${username} from ${clientIP}`);
                
                if (threat !== 'normal') {
                    updateSecurityStatus('warning', `âš ï¸ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¡œê·¸ì¸ íŒ¨í„´ ê°ì§€`);
                }
            } else {
                // ë¡œê·¸ì¸ ì‹¤íŒ¨
                storedData.serverB.authHistory.failedAttempts++;
                storedData.serverB.authHistory.loginHistory.push({
                    timestamp: new Date().toISOString(),
                    success: false,
                    ip: clientIP,
                    threatLevel: threat
                });
                
                showLoginResult('ë¡œê·¸ì¸ ì‹¤íŒ¨! íŒ¨ìŠ¤ì›Œë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ğŸš«', false);
                securityMonitor.logSecurity('warning', `ë¡œê·¸ì¸ ì‹¤íŒ¨: ${username} from ${clientIP} (ì‹¤íŒ¨ íšŸìˆ˜: ${storedData.serverB.authHistory.failedAttempts})`);
                
                // ê³µê²© ëŒ€ì‘
                if (threat === 'ip_attack' || threat === 'brute_force') {
                    securityMonitor.triggerEmergencyResponse(threat, `${username} from ${clientIP}`);
                } else if (threat === 'rapid_attempts') {
                    updateSecurityStatus('warning', 'âš ï¸ ë¹ ë¥¸ ì—°ì† ì‹œë„ ê°ì§€ë¨');
                }
            }
            
            document.getElementById('login-password').value = '';
        }

        // ì„œë²„ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateServerDisplay() {
            const servers = ['A', 'B', 'C', 'D', 'E'];
            
            servers.forEach(server => {
                const serverCard = document.getElementById(`server-${server}`);
                const statusElement = document.getElementById(`status-${server}`);
                const dataElement = document.getElementById(`data-${server}`);
                
                if (serverStatus[server]) {
                    if (isLockdownMode) {
                        serverCard.classList.add('lockdown');
                        serverCard.classList.remove('active', 'error');
                        statusElement.textContent = 'LOCKDOWN';
                        statusElement.className = 'server-status status-lockdown';
                    } else {
                        serverCard.classList.add('active');
                        serverCard.classList.remove('error', 'lockdown');
                        statusElement.textContent = 'ONLINE';
                        statusElement.className = 'server-status status-online';
                    }
                    
                    const serverKey = `server${server}`;
                    let serverData = [];
                    
                    Object.values(userData).forEach(user => {
                        if (user[serverKey]) {
                            serverData.push({
                                user: user.serverA?.metadata?.username || 'unknown',
                                data: user[serverKey]
                            });
                        }
                    });
                    
                    if (serverData.length > 0) {
                        dataElement.innerHTML = serverData.map(item => 
                            `<div style="margin-bottom: 10px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 5px;">
                                <strong>User: ${item.user}</strong>
                                ${item.data.metadata?.isLocked ? '<span style="color: #f44336;"> [LOCKED]</span>' : ''}
                                <br>
                                ${JSON.stringify(item.data, null, 2)}
                            </div>`
                        ).join('');
                    } else {
                        dataElement.textContent = 'ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
                    }
                } else {
                    serverCard.classList.remove('active', 'lockdown');
                    statusElement.textContent = 'OFFLINE';
                    statusElement.className = 'server-status status-offline';
                    dataElement.textContent = 'ì„œë²„ ëŒ€ê¸° ì¤‘...';
                }
            });
        }

        // ì‚¬ìš©ì ëª©ë¡ ì—…ë°ì´íŠ¸ (ë³´ì•ˆ ìƒíƒœ í¬í•¨)
        function updateUserList() {
            const userListContent = document.getElementById('user-list-content');
            
            if (Object.keys(userData).length === 0) {
                userListContent.innerHTML = 'ë“±ë¡ëœ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤.';
                return;
            }
            
            const userItems = Object.entries(userData).map(([username, data]) => {
                const metadata = data.serverA?.metadata || {};
                const authHistory = data.serverB?.authHistory || {};
                const isLocked = metadata.isLocked || lockedAccounts.has(username);
                const isSuspicious = authHistory.suspiciousActivity;
                
                let itemClass = 'user-item';
                if (isLocked) itemClass += ' locked';
                else if (isSuspicious) itemClass += ' suspicious';
                
                return `
                    <div class="${itemClass}">
                        <div>
                            <strong>${username}</strong>
                            ${isLocked ? '<span style="color: #f44336;"> ğŸ”’ [ì ê¸ˆë¨]</span>' : ''}
                            ${isSuspicious && !isLocked ? '<span style="color: #FFC107;"> âš ï¸ [ì˜ì‹¬]</span>' : ''}
                            <br>
                            <small>ìƒì„±: ${new Date(metadata.created).toLocaleString('ko-KR')}</small><br>
                            <small>ìµœê·¼ ì ‘ì†: ${metadata.lastAccess ? new Date(metadata.lastAccess).toLocaleString('ko-KR') : 'ì—†ìŒ'}</small>
                            ${metadata.lockReason ? `<br><small style="color: #f44336;">ì ê¸ˆ ì‚¬ìœ : ${metadata.lockReason}</small>` : ''}
                        </div>
                        <div style="text-align: right;">
                            <div>ë¡œê·¸ì¸ íšŸìˆ˜: ${authHistory.loginCount || 0}</div>
                            <div>ì‹¤íŒ¨ íšŸìˆ˜: ${authHistory.failedAttempts || 0}</div>
                            ${isLocked ? '<button onclick="unlockAccount(\'' + username + '\')" style="background: #4CAF50; border: none; padding: 5px 10px; border-radius: 5px; color: white; font-size: 12px; margin-top: 5px;">ì ê¸ˆ í•´ì œ</button>' : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            userListContent.innerHTML = userItems;
        }

        // ë³´ì•ˆ ë¡œê·¸ ì—…ë°ì´íŠ¸
        function updateSecurityLog() {
            const logContent = document.getElementById('security-log-content');
            
            if (securityLog.length === 0) {
                logContent.innerHTML = '<div class="log-entry log-info">[INFO] ë³´ì•ˆ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            const logEntries = securityLog.slice(-50).reverse().map(entry => {
                const time = new Date(entry.timestamp).toLocaleTimeString('ko-KR');
                return `<div class="log-entry log-${entry.level}">[${time}] [${entry.level.toUpperCase()}] ${entry.message}</div>`;
            }).join('');
            
            logContent.innerHTML = logEntries;
            
            // ìë™ ìŠ¤í¬ë¡¤
            logContent.scrollTop = 0;
        }

        // ì„œë²„ ê´€ë¦¬ ê¸°ëŠ¥ë“¤
        function refreshServers() {
            showAdminStatus('ì„œë²„ ìƒíƒœë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'success');
            
            setTimeout(() => {
                updateServerDisplay();
                updateUserList();
                updateSecurityLog();
                showAdminStatus('ëª¨ë“  ì„œë²„ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                securityMonitor.logSecurity('info', 'ì„œë²„ ìƒíƒœ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ');
            }, 1000);
        }

        function syncServers() {
            showAdminStatus('ì„œë²„ ê°„ ë°ì´í„° ë™ê¸°í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...', 'success');
            
            setTimeout(() => {
                let syncCount = 0;
                Object.keys(userData).forEach(username => {
                    syncCount++;
                });
                
                showAdminStatus(`${syncCount}ê°œ ê³„ì •ì˜ ë°ì´í„° ë™ê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                securityMonitor.logSecurity('info', `ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ: ${syncCount}ê°œ ê³„ì •`);
            }, 1500);
        }

        function clearAllData() {
            if (confirm('âš ï¸ ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                userData = {};
                lockedAccounts.clear();
                suspiciousIPs.clear();
                securityLog = [];
                
                Object.keys(serverStatus).forEach(server => {
                    serverStatus[server] = false;
                });
                
                isLockdownMode = false;
                securityState = 'normal';
                
                updateServerDisplay();
                updateUserList();
                updateSecurityLog();
                showAdminStatus('ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'error');
                
                document.getElementById('signup-result').style.display = 'none';
                document.getElementById('login-result').innerHTML = '';
                document.getElementById('security-alert').style.display = 'none';
                
                securityMonitor.logSecurity('warning', 'ì‹œìŠ¤í…œ ë°ì´í„° ì „ì²´ ì‚­ì œë¨');
            }
        }

        function clearSecurityLog() {
            securityLog = [];
            updateSecurityLog();
            showSecurityStatus('ë³´ì•ˆ ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.', 'success');
        }

        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜ë“¤
        function showUserStatus(message, type) {
            const statusElement = document.getElementById('user-status');
            statusElement.textContent = message;
            statusElement.className = `status-message ${type}`;
            statusElement.style.display = 'block';
            
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 4000);
        }

        function showLoginResult(message, success) {
            const resultElement = document.getElementById('login-result');
            resultElement.innerHTML = `
                <div class="status-message ${success ? 'success' : 'error'}" style="margin-top: 15px;">
                    ${message}
                </div>
            `;
        }

        function showAdminStatus(message, type) {
            const statusElement = document.getElementById('admin-status');
            statusElement.innerHTML = `
                <div class="status-message ${type}">
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                statusElement.innerHTML = '';
            }, 3000);
        }

        function showSecurityStatus(message, type) {
            const statusElement = document.getElementById('security-status');
            statusElement.innerHTML = `
                <div class="status-message ${type}">
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                statusElement.innerHTML = '';
            }, 3000);
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            // ë„¤ë¹„ê²Œì´ì…˜
            document.getElementById('nav-user-site').addEventListener('click', () => showPage('user-site'));
            document.getElementById('nav-server-admin').addEventListener('click', () => showPage('server-admin'));
            document.getElementById('nav-security').addEventListener('click', () => showPage('security-monitoring'));
            
            // ì¸ì¦ íƒ­
            document.getElementById('tab-signup').addEventListener('click', () => switchAuthTab('signup'));
            document.getElementById('tab-login').addEventListener('click', () => switchAuthTab('login'));
            
            // íšŒì›ê°€ì…/ë¡œê·¸ì¸ ë²„íŠ¼
            document.getElementById('signup-btn').addEventListener('click', handleSignup);
            document.getElementById('login-btn').addEventListener('click', handleLogin);
            
            // ì„œë²„ ê´€ë¦¬ ë²„íŠ¼
            document.getElementById('refresh-btn').addEventListener('click', refreshServers);
            document.getElementById('sync-btn').addEventListener('click', syncServers);
            document.getElementById('clear-btn').addEventListener('click', clearAllData);
            
            // ë³´ì•ˆ ê´€ë¦¬ ë²„íŠ¼
            document.getElementById('lockdown-btn').addEventListener('click', () => {
                if (isLockdownMode) {
                    exitSystemLockdown();
                } else {
                    if (confirm('âš ï¸ ì‹œìŠ¤í…œì„ ë³´ì•ˆ ì ê¸ˆ ìƒíƒœë¡œ ì „í™˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        enterSystemLockdown();
                    }
                }
            });

            // ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ë²„íŠ¼ë“¤
            document.getElementById('clear-log-btn').addEventListener('click', clearSecurityLog);
            document.getElementById('test-attack-btn').addEventListener('click', simulateAttack);
            document.getElementById('emergency-lockdown-btn').addEventListener('click', () => {
                if (confirm('ğŸš¨ ê¸´ê¸‰ ë³´ì•ˆ ì ê¸ˆì„ í™œì„±í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nëª¨ë“  ì‚¬ìš©ì ì ‘ê·¼ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.')) {
                    securityMonitor.logSecurity('critical', 'ğŸš¨ ê´€ë¦¬ìì— ì˜í•œ ê¸´ê¸‰ ì ê¸ˆ í™œì„±í™”');
                    enterSystemLockdown();
                }
            });
            
            // Enter í‚¤ ì´ë²¤íŠ¸
            const signupPassword = document.getElementById('signup-password');
            const signupConfirm = document.getElementById('signup-confirm');
            const loginPassword = document.getElementById('login-password');
            
            if (signupPassword) {
                signupPassword.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const confirmField = document.getElementById('signup-confirm');
                        if (confirmField) confirmField.focus();
                    }
                });
            }
            
            if (signupConfirm) {
                signupConfirm.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleSignup();
                });
            }
            
            if (loginPassword) {
                loginPassword.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleLogin();
                });
            }
        }

        // ì£¼ê¸°ì  ë³´ì•ˆ ê²€ì‚¬
        function startSecurityMonitoring() {
            setInterval(() => {
                if (isLockdownMode) return;
                
                // ì˜ì‹¬ìŠ¤ëŸ¬ìš´ IP ìë™ í•´ì œ (10ë¶„ í›„)
                const tenMinutesAgo = Date.now() - 600000;
                let removedIPs = [];
                
                suspiciousIPs.forEach(ip => {
                    // ì‹¤ì œë¡œëŠ” IPë³„ ë§ˆì§€ë§‰ ì‹œë„ ì‹œê°„ì„ ì¶”ì í•´ì•¼ í•¨
                    if (Math.random() < 0.1) { // 10% í™•ë¥ ë¡œ í•´ì œ (ì‹œë®¬ë ˆì´ì…˜)
                        suspiciousIPs.delete(ip);
                        removedIPs.push(ip);
                    }
                });
                
                if (removedIPs.length > 0) {
                    securityMonitor.logSecurity('info', `IP ì°¨ë‹¨ í•´ì œ: ${removedIPs.join(', ')}`);
                }
                
                // ê³„ì • ìë™ ì ê¸ˆ í•´ì œ ê²€ì‚¬
                lockedAccounts.forEach(username => {
                    if (userData[username]) {
                        const lockTime = new Date(userData[username].serverA.metadata.lastAccess).getTime();
                        if (Date.now() - lockTime > 300000) { // 5ë¶„ í›„ ìë™ í•´ì œ ì˜µì…˜
                            // ê´€ë¦¬ì ì„¤ì •ì— ë”°ë¼ ìë™ í•´ì œí•  ìˆ˜ ìˆìŒ
                        }
                    }
                });

                // ì„œë²„ ë¬´ê²°ì„± ê²€ì‚¬
                if (Math.random() < 0.05) { // 5% í™•ë¥ ë¡œ ë¬´ê²°ì„± ê²€ì‚¬
                    securityMonitor.logSecurity('info', 'ì„œë²„ ë¬´ê²°ì„± ê²€ì‚¬ ì™„ë£Œ');
                }
                
            }, 30000); // 30ì´ˆë§ˆë‹¤ ì‹¤í–‰
        }

        // ì´ˆê¸°í™” í•¨ìˆ˜
        function initializeSystem() {
            setupEventListeners();
            startSecurityMonitoring();
            
            // ì´ˆê¸° ë³´ì•ˆ ìƒíƒœ ì„¤ì •
            updateSecurityStatus('normal', 'ğŸ”’ ë³´ì•ˆ ìƒíƒœ ì •ìƒ');
            
            showAdminStatus('ë¶„ì‚° íŒ¨ìŠ¤ì›Œë“œ ë³´ì•ˆ ì‹œìŠ¤í…œì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ğŸš€', 'success');
            securityMonitor.logSecurity('info', 'ğŸ›¡ï¸ SecureAuth ë³´ì•ˆ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
            securityMonitor.logSecurity('info', 'ì¹¨ì… íƒì§€ ì‹œìŠ¤í…œ í™œì„±í™”ë¨');
            
            console.log('SecureAuth System with Enhanced Security initialized');
            console.log('ChaoticRNG hash algorithm loaded');
            console.log('5-Way split server architecture ready');
            console.log('Intrusion Detection System active');
        }

        // DOM ë¡œë“œ ì™„ë£Œ í›„ ì´ˆê¸°í™”
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeSystem);
        } else {
            initializeSystem();
        }
    </script>
</body>
</html>
